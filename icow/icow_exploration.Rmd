---
title: "ICOW exploration"
output:
  html_document:
    fig_height: 3
    fig_width: 5
--- 

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache=T)
```
<br>

#Intro
In this investigation, I use Paul Hensen's ICOW Colonial History Data Set which you can find hosted ([here](http://www.paulhensel.org/icowcol.html)), a copy of which I've hosted on GitHub ([here](https://raw.githubusercontent.com/danielnjoo/public_data/master/coldata100.csv)). 

> The ICOW colonial history data set attempts to identify colonial or other dependency relationships for each state over the past two centuries. This includes states that have ruled each state as a colony, dependency, League of Nations mandate, UN trust territory, or other type of possession, as well as states that have seceded from existing states and states that have merged into existing states. This should be most useful for analyses of a variety of possible propositions on the general impact of colonial rule... and similar topics. 

I look at potential relationships between variables in `icow` and certain socio-economic factors such as:

* `lifeexp`: 183 countries/territories for which there is WHO data, [link](https://en.wikipedia.org/wiki/List_of_countries_by_life_expectancy)
       + Q: investigate if there is a relationship between date of independence and modern life expectancy

* `population`: 232 countries/territories for which there is population data from 1950-- there are 108 countries in the `icow` dataset that became independent after 1950, [link](https://en.wikipedia.org/wiki/List_of_countries_by_past_population_(United_Nations,_estimates))
       + Q: investigate if there is a relationship between date of independence and population growth

To be completed:

* `developmentaid`: 138 countries for which there is 2012 and 2013 data for official development aid received, [link](https://en.wikipedia.org/wiki/List_of_countries_by_Official_Development_Assistance_received)
       + Q: investigate if there is a relationship between ex-colonizer and aid received

* `firstmarriage`: 122 countries for which there is the average age of first marriage, as well as average male/female age, and age gap, for 122 countries, [link](https://en.wikipedia.org/wiki/List_of_countries_by_age_at_first_marriage)
       + Q: investigate if there is a relationship between age-gap/average gap in the colonizer and that of the colonized

* `irri`: 239 countries/territories by irrigated land area, [link](https://en.wikipedia.org/wiki/List_of_countries_by_irrigated_land_area)
       + Q: investigate if there is a relationship between a colonys' irrigated land area and its date of colonization

* `socialprogress`: 163 countries, likely mirrors findings of `lifeexp` [link](https://en.wikipedia.org/wiki/List_of_countries_by_Social_Progress_Index)

<br>

#Data & Prep
All code is included in the appendix.

###Load libraries
```{r libraries.etc, echo=FALSE, message=FALSE}

#libraries
cachedata = TRUE
cachemodels = TRUE
library(knitr)
library(tidyr)
library(dplyr)
library(ggplot2)
library(stringr)
library(lubridate)
library(mosaic)
library(countrycode)
library(viridis)
library(rvest) #doc https://cran.r-project.org/web/packages/rvest/rvest.pdf
print("loaded knitr, tidyr, dplyr, ggplot2, stringr, lubridate, mosaic, countrycode, viridis, and rvest libraries")

```
###Load and prep `icow`
This Colonial History dataset (`icow`) features 217 observations across 15 variables, which are described in detail in the accompanying markdown file ([here](https://github.com/danielnjoo/public_data/blob/master/README.md)). We write a new variable here `Year of Independence` which is a R-friendly conversion of `IndDate`.

Let's take a quick look at the variables we have available:

```{r load icow, echo=F}
#loading icow
icow<-read.csv("https://raw.githubusercontent.com/danielnjoo/public_data/master/coldata100.csv") %>% 
  arrange(Name)
icow$Name<-str_trim(vapply(strsplit(as.character(icow$Name), "(", fixed=T), `[`, 1, FUN.VALUE=character(1))) #get rid of parenthesised names
temp<-c(51, 66, 100, 161)
icow[temp,5]<-paste0('0',icow[temp,5]) #france and denmark were independent before 1000, prepend a 0
temp<-c(39, 51, 66, 89, 93, 95, 100, 123, 143, 147, 161, 190, 194, 199)
icow[temp,5]<-paste0(substr(icow[temp,5], 1, nchar(icow[temp,5])-1),'1') #some IndDates end in 00, replace last 0 with 1
icow$`Year of Independence` <- as.Date(paste0(as.character(icow$IndDate),'01'), format='%Y%m%d')

```

```{r dim}
#dimensions and variables
dim(icow); names(icow)

```

###Duplicate some `icow` entries
Because of inconsistent country naming on Wikipedia, e.g. `United States` and `United States of America`, or `Congo, Dem. Rep.` and `Republic of Congo`, I duplicated some entries so `dplyr::inner_join()` could have a common key to join them by. I considered using `adist()` which measures approximate string distance, but it seemed more trouble than it was worth because of the many edge cases for which it might not work. I later do use the `countrycode` package for converting from `wrld_data('world')` to `icow` friendly codes.

```{r icow manip, echo=F}
#duplicating icow entries
icow[55,] %>% rep() -> icow[218,]; icow[218,2] <- "Timor-Leste"
icow[204,] %>% rep() -> icow[219,]; icow[219,2] <- "United States"
icow[141,] %>% rep() -> icow[220,]; icow[220,2] <- "DPR Korea"
icow[158,] %>% rep() -> icow[221,]; icow[221,2] <- "Russian Federation"
icow[50,] %>% rep() -> icow[222,]; icow[222,2] <- "DR Congo"
icow[117,] %>% rep() -> icow[223,]; icow[223,2] <- "Maldives"
icow[63,] %>% rep() -> icow[224,]; icow[224,2] <- "Micronesia"
icow[209,] %>% rep() -> icow[225,]; icow[225,2] <- "Vietnam"
icow[179,] %>% rep() -> icow[226,]; icow[226,2] <- "Saint Lucia"
icow[180,] %>% rep() -> icow[227,]; icow[227,2] <- "Saint Vincent and the Grenadines"
icow[214,] %>% rep() -> icow[228,]; icow[228,2] <- "Serbia"
icow[6,] %>% rep() -> icow[229,]; icow[229,2] <- "Antigua & Barbuda"
icow[25,] %>% rep() -> icow[230,]; icow[230,2] <- "Bosnia-Herzegovina"
icow[222,] %>% rep() -> icow[231,]; icow[231,2] <- "Congo, Dem. Rep."
icow[42,] %>% rep() -> icow[232,]; icow[232,2] <- "Congo, Rep."
icow[44,] %>% rep() -> icow[233,]; icow[233,2] <- "Côte d'Ivoire"
icow[63,] %>% rep() -> icow[234,]; icow[234,2] <- "Micronesia, Federated States of"
icow[178,] %>% rep() -> icow[235,]; icow[235,2] <- "St. Kitts & Nevis"
icow[162,] %>% rep() -> icow[236,]; icow[236,2] <- "São Tomé and Príncipe"
icow[222,] %>% rep() -> icow[237,]; icow[237,2] <- "Democratic Republic of the Congo"
icow[178,] %>% rep() -> icow[238,]; icow[238,2] <- "Saint Kitts and Nevis"
icow[44,] %>% rep() -> icow[239,]; icow[239,2] <- "Ivory Coast"
icow[42,] %>% rep() -> icow[240,]; icow[240,2] <- "Republic of the Congo"
icow[160,] %>% rep() -> icow[241,]; icow[241,2] <- "American Samoa"
icow[63,] %>% rep() -> icow[242,]; icow[242,2] <- "Federated States of Micronesia"
icow[35,] %>% rep() -> icow[243,]; icow[243,2] <- "Cabo Verde"

```

```{r dim2}
#dim after duplications
dim(icow) 

```
###Scraping function, etc.
I create two functions, `scrapefun()` which itself calls `clean()`. `clean()` takes a column (vector) and strips any ()'s or []'s from every entry, then returning the result. This is necessary because many country names in Wikipedia's tables are appended by additional names in parentheses or footnotes, e.g. "Serbia [5]".
```{r scrape fun, echo=F}
#functions
scrapefun <- function(url, pos=1, col=1){
  temp<-read_html(url) %>% html_table(header=T, fill=T) %>% .[[pos]] %>% arrange(.[,col])
  temp[,col]<-clean(temp[,col]); temp}

clean <- function(column){
  temp<-str_trim (vapply (strsplit(as.character(column), "(", fixed=T), `[`, 1, FUN.VALUE=character(1)))
  str_trim (vapply (strsplit(as.character(temp), "[", fixed=T), `[`, 1, FUN.VALUE=character(1)))   }

decade<-function(inp){
  if(!is.numeric(inp)){print("non-numeric")}
  inp %>% as.numeric -> temp
  temp-temp%%10
}

```
###Data Scraping

I then scraped the datasets outlined in the intro.

```{r data scraping, echo=F, cache=T}
#datascraping
lifeexp<-scrapefun("https://en.wikipedia.org/wiki/List_of_countries_by_life_expectancy")

developmentaid<-scrapefun("https://en.wikipedia.org/wiki/List_of_countries_by_Official_Development_Assistance_received",col=2)
developmentaid<-developmentaid %>% filter(Country!="[TOTAL]")

pop<-scrapefun("https://en.wikipedia.org/wiki/List_of_countries_by_past_population_(United_Nations,_estimates)",col=1)

irri<-scrapefun("https://en.wikipedia.org/wiki/List_of_countries_by_irrigated_land_area", pos=3)

socialprogress<-scrapefun("https://en.wikipedia.org/wiki/List_of_countries_by_Social_Progress_Index", pos=4)

url="https://en.wikipedia.org/wiki/List_of_countries_by_age_at_first_marriage"
firstmarriage<-rbind(scrapefun(url,1), scrapefun(url,2), scrapefun(url,3), scrapefun(url,4)) #won't scrape last table for some reason, Oceania, n=10

```

<br>

#Investigation
###ICOW - a first look, `Year of Independence`

```{r icow expl1, include=F}
names(icow)
```
`Year of Independence` stands out as an interesting place to first explore the `icow` dataset. Observing the data on a continuous scale, we observe peaks starting in the 1800s, but the picture isn't too clear. Looking only at decades with cases of countries becoming independent provides better context.

<br>

```{r icow expl2, echo=F, fig.height=5, fig.width=8}
#initial look
icow  %>% distinct(State, .keep_all=T) %>% 
  ggplot(aes(`Year of Independence`))+geom_density()+ggtitle("`icow` Independence (Continuous Scale)")+theme(plot.title = element_text(hjust = 0.5))

icow %>% distinct(State, .keep_all=T) %>% .$`Year of Independence`  %>%
  year() %>% decade() %>% mosaic::tally() %>% as.data.frame() %>% ggplot(aes(X, Freq)) + geom_bar(stat='identity') + theme(axis.text.x = element_text(angle=90, vjust=0.5,hjust=1), plot.title = element_text(hjust = 0.5))+xlab("Decade of Independence")+ggtitle("`icow` Independence by Decade (Discontinuous Scale)")+ylab("Count")

```

<br>

Clearly, more countries (as we know them) became independent in the last few centuries, especially in the period 1950-1990, while the 1960s stands out as the decade with the most countries becoming independent.

This can nicely be related to Samuel Huntington's 'Waves of Democracy' model, which describes three major global waves of democratization: the first taking place in the nineteenth century, the second following WW2, and the third wave starting in the 1970's. You can read more about his hypothesis ([here](https://en.wikipedia.org/wiki/Third_Wave_Democracy)). This supports the idea that democracy is correlated with independence.

This effect can be seen by mapping the cumulative number of independent countries as denoted by their `Year of Independence` against the cumulative number of democracies. 

Data on the latter is available thanks to the work of C. Boix, M. Miller, S. Rosato, for creating `A Complete Dataset of Political Regimes, 1800-2007`, the most complete dataset on democracies, paper [here](https://www.princeton.edu/~cboix/Boix_Miller_Rosato%20--%20Final_CPS.pdf). Copy of raw count data [here](https://github.com/danielnjoo/public_data/blob/master/democracy_data.csv).

```{r icow expl3, echo=F, fig.height=5, fig.width=8, message=F}
#democracies
temp<-read.csv('https://raw.githubusercontent.com/danielnjoo/public_data/master/democracy_data.csv')
icow  %>% distinct(State, .keep_all=T) %>% filter(as.numeric(year(`Year of Independence`))>1800) %>% mutate(year=year(`Year of Independence`)) %>% inner_join(temp, by=c("year"="year")) %>% 
  ggplot(aes(`Year of Independence`))+
    geom_density(aes(y=cumsum(..count..)))+
    geom_smooth(data=temp,aes(as.Date(paste0(year,"-01-01")),count/117, col="Cumulative Democracies"), se=F)+
    ggtitle("cum# Independent vs. cum# Democracies")+
    theme(plot.title = element_text(hjust = 0.5))+
    ylab("Cumulative Countdecade(year('2006-06-01'))")

```

<br>

###ICOW - `ColRuler`

Next, we might look at `ColRuler`, the primary colonial ruler, defined in the dataset as the imperial entity most responsible for shaping the development of the country in question. I use `countrycode` to map the country.names of `map_data('world')` to Correlates of War codes which are present in the `icow` dataset. `inner_join`ing the results we get a dataset of dimensions 219 x 22.

With the `inner_join`ed dataset, I convert Correlate of War codes back into useable country names, and refactor some because of length, e.g. United Kingdom of Great Britain and Northern Ireland -> UK.

```{r colruler, include=F, warning=F, message=F}
#colruler 
wrld <- map_data('world') %>% filter(region!='Antarctica') #dont need Antarctica
namesinmap <- wrld %>% distinct(region, .keep_all=T)
namesinmap <- namesinmap %>% 
  mutate("State"=countrycode(namesinmap$region,'country.name','cown'))
icowMap<-inner_join(icow,namesinmap)
icowMap<-icowMap %>% mutate(ColRulerN=countrycode(icowMap$ColRuler,'cown','country.name'))
icowMap$ColRulerN<-gsub("United Kingdom of Great Britain and Northern Ireland", "UK", icowMap$ColRulerN)
icowMap$ColRulerN<-gsub("United States of America", "USA", icowMap$ColRulerN)
icowMap$ColRulerN<-gsub("Russian Federation", "Russia", icowMap$ColRulerN)
icowMap$ColRulerN<-gsub("Austria-Hungary", "Austria-H", icowMap$ColRulerN)

```
If we look at the countries that didn't map successfully, most aren't countries that exist today, or are already included by another name in the `icow` dataset. So we can proceed.
```{r colruler2, message=F}
#colruler2
dim(icowMap); anti_join(icow,icowMap) %>% .$Name

```
Lets look at `ColRuler`s: 

(Note %s don't add to 100 because NA (n=31) have been excluded from this table)
```{r colruler3, echo=F}
#colruler3
temp<-icowMap %>% group_by(ColRulerN) %>% filter(!is.na(ColRulerN)) %>% summarise(Count=n(), Proportion=Count/219*100) %>% arrange(desc(Count)) %>% as.data.frame(); temp

```

What does this look like more graphically?

<br>

```{r colruler4, fig.height=4,fig.width=10,  echo=F}
#colruler4
temp %>% ggplot(aes("",Proportion,fill=ColRulerN))+geom_bar(width=1,stat='identity')+
  theme(axis.text.x = element_blank(), panel.grid=element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank(), plot.title = element_text(hjust = 0.5), legend.title=element_blank() )+
  ggtitle("Proportion of non-NA Colonies by Colonial Ruler")+
  scale_fill_viridis(discrete=T) +coord_polar("y", start=0)

```

<br>

Does that fit what you previously thought? Maybe, it's more clear / less shocking / more shocking if we plot `ColRuler`s on a map!

<br>

```{r colruler5,fig.height=6,fig.width=9, echo=F, warning=F}
#colruler5
gg<-ggplot() + geom_map(data=wrld, map=wrld, aes(long, lat, map_id=region)) + theme_map() +  theme(legend.position='bottom', plot.title = element_text(hjust = 0.5))
gg+geom_map(data=icowMap, map=wrld, aes(fill=ColRulerN,map_id=region)) + scale_fill_viridis(discrete=T, guide=guide_legend()) + ggtitle("World Map by Primary Colonial Rulers")

```

Look at Spain, Portugal, and the UK...

<br>

###ICOW - `IndViol` 

Let's next look at cases of violent independence / secession, as encoded by `IndViol` and `SecViol`. Here, all cases of violent secession are cases of violent independence, i.e. the difference is that the country in question fought for independence against its coloninal ruler.
```{r Viol, echo=F}
#secViol and indViol
icow %>% summarise(IndViolCount=sum(IndViol==1), SecViolCount=sum(SecViol==1), SecAndIndViolCount=sum(SecViol==1 & IndViol==1))

```

Looking at `IndViol` on a map

```{r Viol2, echo=F,fig.height=6,fig.width=9}
#IndViol
gg+geom_map(data=icowMap, map=wrld, aes(fill=as.factor(IndViol), map_id=region)) + scale_fill_viridis(discrete=T, guide=guide_legend()) + ggtitle('Countries That Fought For Independence') + labs(fill='IndViol') 


```

Looking at `IndViol` by `ColRuler`. First, we notice that there are 20 counts of NA for countries that fought for their independence but are noted as having no primary colonial ruler. 

```{r Viol3, echo=F}
#IndViol2
temp<-icowMap %>% filter(IndViol==1)
temp %>% group_by(ColRulerN) %>% summarise(count=n()) %>% as.data.frame()

```

These are countries with complicated histories: e.g. in 1368, China's Mongol-led Yuan Dynasty collapsed after Han Chinese rebellions which resulted in the formation of the Ming Dynasty. Similarly, in the case of the UK, the Normans conquered the UK from the Anglo-Saxons, and therefore independence was fought for, but it's hard to decide whether there ever was a previous colonial ruler, or even if there was, it doesn't exist a modern nation-state.

```{r Viol4, echo=F}
#IndViol3
temp %>% filter(is.na(ColRulerN)) %>% dplyr::select(region, `Year of Independence`, ColRulerN)

```

Plotting the countries which we have `ColRuler` data for on a map...

```{r Viol5, echo=F, fig.height=6,fig.width=9}
#IndViol4
gg+geom_map(data=temp, map=wrld, aes(fill=as.factor(ColRulerN), map_id=region)) + scale_fill_viridis(discrete=T, guide=guide_legend()) + ggtitle('Countries That Fought For Independence By Their Colonial Ruler') + labs(fill='ColRuler') 


```


<br>

###Real Data: The Importance of Independence in Life Expectancy
I scraped `lifeexp` data from Wikipedia ([here](https://en.wikipedia.org/wiki/List_of_countries_by_life_expectancy)) which used 2015 data from the World Health Organization. 

> Worldwide, the average life expectancy at birth was 71.5 years (68 years and 4 months for males and 72 years and 8 months for females) over the period 2010–2015 according to United Nations World Population Prospects 2015 Revision. 

It's interesting to note that Hong Kong is the territory with the world's highest life expectancy according to Hong Kong Department of Health, the life expectancy reached 84.0 years in 2015 surpassing Japan's 83.7 years. However, this data is not included in the following WHO statistics as a separate entity since Hong Kong is a Special Administrative Region of China

After `inner_join()`ing the `lifeexp` data with the `icow` data, we're left with 183 unique observations across 24 variables (although we have `icow` data for every observation in `lifeexp`, the converse isn't true! But that's ok: 217-183 = 34, i.e. we lost 34 countries due to non-existence, or lack of WHO data). 

```{r lifeexp prep, include=F, message=F}
#lifeexp
temp<-inner_join(lifeexp,icow, by=c("Country"="Name")) %>% arrange(`Both sexes\nrank`); 
dim(lifeexp); dim(temp); temp %>% distinct() %>% dim() #1-1 unique

```

The top 3 and bottom 3 are shown below:

```{r lifeexp prep2, echo=F}
#lifeexp2
temp %>% head(3) %>% .[,1:2]
temp %>% tail(3) %>% .[,1:2]

```

First looking at life expectancy vs year of independence, we notice that the countries with the lowest life expectancies today have been independent for the shortest period of time.

```{r lifeexp plot, message=F, fig.width=8, fig.height=4}
#lifeexp3
temp2<-temp %>% mutate(bottom10pc=ifelse(`Both sexes\nrank`>165, 1, 0)) #bottom 10% are ranked 165 or greater
ggplot(data=temp2, aes(`Year of Independence`,`Both sexes life\nexpectancy`, col=as.factor(bottom10pc)))+geom_point()+ggtitle("Life Expectancy vs Year of Independence with Bottom 10% Colored")+labs(col="Bottom 10%")

```

The general negative linear relationship between the two variables means that if you built a predictive, linear model based **solely** on `Year of Independence`... you'd find that the model could predict a country's life expectancy rate within a surprisingly narrow (4-5 years) 95% confidence band. 

That model would predict that for every 600 years longer a country is independent, its inhabitants would be expected to live 10 years longer. 

```{r lifeexp plot2, echo=F, message=F, fig.width=6, fig.height=4}
#lifeexp4
temp %>% ggplot(aes(`Year of Independence`,`Both sexes life
expectancy`))+geom_point()+geom_smooth(method='lm')+ggtitle("Life Expectancy on Year of Independence")

```

However, this approach is of course not statistically sound: our data is not normally distributed at all: remember how `Year of Independence` was distributed?

<br>

### More Data: Population

Historical population data that stretches as far back as the `icow` dataset is hard to find. The oldest respectable data I could find was UN estimates that go back to 1950 for 232 territories which I scraped from ([here](https://en.wikipedia.org/wiki/List_of_countries_by_past_population_(United_Nations,_estimates))). After `inner_join`ing we have 193 entries (from 219 rows in the original `icow` dataset). 

Further, if we filter out countries that became independent before 1950, we are left with a working dataset of 108 countries which became independent during the period for which we have population data.

```{r pop}
#pop
icowMap%>% inner_join(pop, by=c("Name"="Country / territory")) %>% dim()
icowMap %>% inner_join(pop, by=c("Name"="Country / territory")) %>% filter(year(`Year of Independence`)>1950) %>% dim()

```

The data has 13 readings at 5 year intervals between 1950-2015, but we're interested in **population growth** in order to account for different *initial* population sizes. So I created 12 variables that measured population growth over the appropriate interval (therefore they are *not* annual growth rates.

```{r pop1, include=F}
#pop
temp<-icowMap %>% inner_join(pop, by=c("Name"="Country / territory")) %>% filter(year(`Year of Independence`)>1950)
for(j in 1:nrow(temp)){
  for(i in 1:13){
      newCol <- paste0(names(temp)[23+i],"-",names(temp)[24+i])
      temp[j,newCol] <- (as.numeric(gsub(",","",temp[j,24+i]))-as.numeric(gsub(",","",temp[j,23+i])))*100/as.numeric(gsub(",","",temp[j,23+i]))
  }
}

```

```{r pop2}
names(temp)[38:50]
```

```{r pop3, include=F}
#creating means
temp2<-temp %>% mutate(decade=decade(year(`Year of Independence`))) %>% 
  group_by(decade) %>% 
  summarise(`1950to1955`=mean(`1950-1955`),
            `1955to1960`=mean(`1955-1960`),
            `1960to1965`=mean(`1960-1965`),
            `1965to1970`=mean(`1965-1970`),
            `1970to1975`=mean(`1970-1975`),
            `1975to1980`=mean(`1975-1980`),
            `1980to1985`=mean(`1980-1985`),
            `1985to1990`=mean(`1985-1990`),
            `1990to1995`=mean(`1990-1995`),
            `1995to2000`=mean(`1995-2000`),
            `2000to2005`=mean(`2000-2005`),
            `2005to2010`=mean(`2005-2010`),
            `2010to2015`=mean(`2010-2015`), 
            count=n()
            ) 
temp3<-temp2 %>% gather("5y period", "population growth in that period", 2:14)
```

Let's take our first look at population growth by decade

```{r pop4, echo=F, fig.width=7, fig.height=5}
#first look at population growth by decade
temp3 %>% ggplot(aes(`5y period`, `population growth in that period`, group=decade, col=decade))+geom_point()+geom_line()+theme(axis.text.x = element_text(angle=45,hjust=1), plot.title = element_text(hjust = 0.5))+labs(col="Decade of Ind.")+ggtitle("Population Growth by Decade of Ind")

```

We see that the most recent decade 2010 stands out. If we look at it, we notice that this is because it is comprised of just one country: South Sudan. 

```{r pop5}
temp %>% filter(decade(year(`Year of Independence`)) %in% c(2010,2000)) %>% dplyr::select(Name,`Year of Independence`)
```

Otherwise, the general trend appears to be that older countries have both higher and more stable population growth)

Let's see if `ColRuler` has any effect on population growth. The first thing to do is look at the `count` of each ex-colony by `ColRuler`. Since our dataset only contains countries that became independent after 1950, it's heavily skewed towards... the UK/France/Russia

```{r pop6, include=F}
#prep data
temp4<-temp %>% group_by(ColRulerN, IndViol) %>% 
  summarise(y1950to1955=mean(`1950-1955`),
            y1955to1960=mean(`1955-1960`),
            y1960to1965=mean(`1960-1965`),
            y1965to1970=mean(`1965-1970`),
            y1970to1975=mean(`1970-1975`),
            y1975to1980=mean(`1975-1980`),
            y1980to1985=mean(`1980-1985`),
            y1985to1990=mean(`1985-1990`),
            y1900to1995=mean(`1990-1995`),
            y1995to2000=mean(`1995-2000`),
            y2000to2005=mean(`2000-2005`),
            y2005to2010=mean(`2005-2010`),
            y2010to2015=mean(`2010-2015`),  
            count=n()
            ) %>% 
   gather("5y period", "population growth in that period", 2:14)
```

```{r pop7}
#look at top `ColRulers`
temp4 %>% distinct(ColRulerN, .keep_all=T) %>% select(count, ColRulerN) %>% arrange(desc(count)) %>% head()

```
```{r pop8, include=F}
#plot it
temp4 %>% ggplot(aes(`5y period`, `population growth in that period`, group=ColRulerN, col=as.factor(ColRulerN)))+geom_point()+geom_line()+theme(axis.text.x = element_text(angle=45,hjust=1), plot.title = element_text(hjust = 0.5))+labs(col="Decade of Ind.")+ggtitle("Population Growth by Decade of Ind")

```

If we look only at the top 3:

```{r pop9, echo=F, fig.width=7, fig.height=5, message=F}
#plot again
temp4 %>% filter(count>3) %>% arrange(count) %>% ggplot(aes(`5y period`, `population growth in that period`, group=ColRulerN, col=as.factor(ColRulerN)))+geom_smooth(se=F)+theme(axis.text.x = element_text(angle=45,hjust=1), plot.title = element_text(hjust = 0.5))+labs(col="Decade of Ind.")+ggtitle("Population Growth by Decade of Ind")

```

A clear trend appears to emerge that UK/French colonies grew much faster in terms of population after 1970 as compared to Turkish/Russian colonies. This cannot be explaiend by a small sample size either because there were far more of the former than of the latter.

###Other Data

To be continued


# Appendix
```{r, ref.label=knitr::all_labels(),echo=TRUE,eval=FALSE}
```